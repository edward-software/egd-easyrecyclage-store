
<div class="infoproduct">

    <div class="infoproduct__close"
    data-url="{{ path('paprec_public_corp_d3e_subscription_infoproduct', {cartUuid: cart.id, productId: product.id}) }}"
    id="infoProductClose_{{ product.id }}"></div>

    <div class="infoproduct__type__title">
        <p>{{ product.name }}</p>
    </div>

    {% set productHasContent = '0' %}
    {% for key, content in cart.content %}
        {% if product.id == key %}
            {% set productHasContent = '1' %}
        {% endif %}
    {% endfor %}
    {% if cart.content is empty or productHasContent == '0' %}
        <div class="infoproduct__type">
            <div class="infoproduct__type__left">
                <div class="infoproduct__title infoproduct__title--type">
                    {{ ('Public.Cart.TrashType'|trans)|upper }}
                </div>
                <div class="-align-right">
                    <select class="infoproduct__type__input infoproduct__typeSelect">
                        <option disabled selected
                                value> {{ 'Public.Cart.ChooseTrash'|trans }} </option>
                        {% for productType in productTypes %}
                            {% for type in productType %}
                                <option value="{{ type.id }}">{{ type.name }}</option>
                            {% endfor %}
                        {% endfor %}
                    </select>
                </div>
                <div class="clearfix"></div>
                <br>
                <div class="infoproduct__title infoproduct__title--type">{{ ('Public.Cart.Options'|trans)|upper }}</div>
                <div class="-align-right">
                    <input type="checkbox"
                           class="infoproduct__type__checkbox infoproduct__type__checkbox__optHandlingProductSelect"
                           id="optHandlingProductSelect">
                    {{ 'Commercial.ProductD3EOrderLine.OptHandling'|trans }}<br>

                    <input type="checkbox"
                           class="infoproduct__type__checkbox infoproduct__type__checkbox__optSerialNumberStmtProductSelect"
                           id="optSerialNumberStmtProductSelect">
                    {{ 'Commercial.ProductD3EOrderLine.OptSerialNumberStmt'|trans }}<br>

                    <input type="checkbox"
                           class="infoproduct__type__checkbox infoproduct__type__checkbox__optDestructionProductSelect"
                           id="optDestructionProductSelect">
                    {{ 'Commercial.ProductD3EOrderLine.OptDestruction'|trans }}<br>
                </div>
            </div>
            <div class="infoproduct__type__right">
                <div class="infoproduct__pieces">{{ 'Public.Cart.PiecesNumber'|trans }}</div>
                <div class="-align-right">

                    <select name=""
                            id="quantityProducSelect_{{ product.id }}"
                            class="infoproduct__qty">
                        {% for i in 1..20 %}
                            <option value="{{ i }}">{{ i }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </div>
    {% else %}
        {% for key, content in cart.content %}
            {% set i = loop.index0 %}
            {% if key == product.id %}
                {% for types in content %}
                    <div class="infoproduct__type">
                        <div class="infoproduct__close removeTypeD3E"
                             data-url="{{ path('paprec_public_corp_d3e_subscription_removeType', {cartUuid: cart.id, productId: product.id, typeId: types['tId']}) }}"
                             data-id="{{ product.id }}"
                             id="infoProductClose_{{ product.id }}"></div>
                        <div class="infoproduct__type__left">
                            <div class="infoproduct__title">
                                {{ ('Public.Cart.TrashType'|trans)|upper }}
                            </div>
                            <div class="-align-right">
                                <select class="infoproduct__type__input infoproduct__typeSelect">
                                    <option disabled selected
                                            value> {{ 'Public.Cart.ChooseTrash'|trans }} </option>

                                    {% for productType in productTypes %}
                                        {% for type in productType %}
                                            <option value="{{ type.id }}"
                                                    {% if type.id == types['tId'] %} selected="selected" {% endif %}>{{ type.name }}
                                            </option>
                                        {% endfor %}
                                    {% endfor %}
                                </select>
                            </div>

                            <div class="clearfix"></div>

                            {# Si le produit sélectionné est déjà dans le Cart on récupère la quantité et les options qui étaient choisis #}
                            {% set qtty = '' %}
                            {% set optHandling = '' %}
                            {% set optSerialNumberStmt = '' %}
                            {% set optDestruction = '' %}
                            {% set qtty = types['qtty'] %}
                            {% if types['optHandling'] == '1' %}
                                {% set optHandling = '1' %}
                            {% endif %}
                            {% if types['optSerialNumberStmt'] == '1' %}
                                {% set optSerialNumberStmt = '1' %}
                            {% endif %}
                            {% if types['optDestruction'] == '1' %}
                                {% set optDestruction = '1' %}
                            {% endif %}
                            <br>

                            <div class="infoproduct__title">{{ ('Public.Cart.Options'|trans)|upper }}</div>
                            <div class="-align-right">
                                <input type="checkbox"
                                       id="optHandlingProductSelect"
                                       class="infoproduct__type__checkbox infoproduct__type__checkbox__optHandlingProductSelect"
                                        {% if optHandling is defined and optHandling == '1' %} checked{% endif %}>
                                {{ 'Commercial.ProductD3EOrderLine.OptHandling'|trans }}<br>

                                <input type="checkbox"
                                       id="optSerialNumberStmtProductSelect"
                                       class="infoproduct__type__checkbox infoproduct__type__checkbox__optSerialNumberStmtProductSelect"
                                        {% if optSerialNumberStmt is defined and optSerialNumberStmt == '1' %} checked{% endif %}>
                                {{ 'Commercial.ProductD3EOrderLine.OptSerialNumberStmt'|trans }}
                                <br>

                                <input type="checkbox"
                                       id="optDestructionProductSelect"
                                       class="infoproduct__type__checkbox infoproduct__type__checkbox__optDestructionProductSelect"
                                        {% if optDestruction is defined and optDestruction == '1' %} checked{% endif %}>
                                {{ 'Commercial.ProductD3EOrderLine.OptDestruction'|trans }}<br>
                            </div>
                        </div>
                        <div class="infoproduct__type__right">
                            <div class="infoproduct__pieces-number">{{ 'Public.Cart.PiecesNumber'|trans }}</div>
                            <select name=""
                                    id="quantityProducSelect_{{ product.id }}"
                                    class="infoproduct__qty">
                                {% for i in 1..20 %}
                                    {% if i == qtty %}
                                        <option value="{{ i }}"
                                                selected="selected">{{ i }}</option>
                                    {% else %}
                                        <option value="{{ i }}">{{ i }}</option>

                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                {% endfor %}
            {% endif %}
        {% endfor %}
    {% endif %}
    <div class="button-container">
        <div class="button-align-container">
            <a class="addNewTypeButton"><p>+</p>{{ 'Public.Cart.NewType'|trans }}</a>
            <a class="button button--lightgreen addToCartSubmitButton waves-effect addToCartD3E"
               data-id="{{ product.id }}"
               data-url="{{ path('paprec_public_corp_d3e_subscription_addContent', {cartUuid: cart.id}) }}"
               id="addToCartSubmitButton_{{ product.id }}">{{ ('Public.Cart.AddToCart' ~ cart.type|capitalize)|trans }}
            </a>
        </div>
    </div>
</div>
